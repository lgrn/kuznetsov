#
# ANSIBLE TEMPLATE - IF YAML, DO NOT EDIT THIS FILE
#

# LXD HOSTS

{% for host in groups['lxd_hosts'] %}
{% set h = hostvars[host] %}
Host {{ host }}
  HostName {{ h['ansible_host'] }}
  Port {{ h['ansible_port'] }}
  User {{ h['ansible_user'] }}
  IdentityFile {{ h['ansible_ssh_private_key_file'] }}
  ForwardAgent yes
{% endfor %}

# LXD CONTAINERS

{% for container in groups['lxd_containers'] %}
{% set c = hostvars[container] %}
Host {{ container }}
  ProxyJump {{ c['parent'] }}
  User root
  HostName {{ c['ip'] | ansible.utils.ipaddr('address') }}
  PreferredAuthentications publickey
  StrictHostKeyChecking no
  UserKnownHostsFile=/dev/null
  IdentityFile ~/.ssh/id_ed25519_2022
{% endfor %}

#
# ANSIBLE TEMPLATE - IF YAML, DO NOT EDIT THIS FILE
#